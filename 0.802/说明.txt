一、LightGBM 模型方案
1.1特征工程
1，每日活跃时间的最大值最小值
2，点击次数总和
3，用户被曝光的不同广告的个数
1.2模型训练
使用五折交叉验证训练 LightGBM 模型。
二、NN 模型方案
2.1特征工程
对用户有点击行为的 adv_prim_id 和 adv_id 构成序列数据，对所有类别变量进行 LabelEncoding。
2.2模型结构
模型的第一个部分是FM，对广告组的类别以及用户组的类别变量进行特征交叉。
模型的第二个部分是使用双向GRU对用户历史adv_prim_id 和 adv_id序列数据建模，将二者最后一个时间步的输出拼接后添加几个全连接层。
模型的第三个部分是将前两个部分的输出合并起来，使用全连接层完成点击率的预测。
2.3模型训练
使用五折交叉验证训练NN模型。
三、模型融合
分别将模型1（LightGBM ）与模型2（NN）对训练集与测试集的预测结果lgb_oof与nn_oof作为特征，使用新的模型3（LightGBM ）模型对这两个特征进行训练与预测，再次将训练集与测试集的预测结果stacking_oof 作为模型1（LightGBM ）的新特征重新训练，得到lgb_oof2，另外，重新训练模型2（NN）得到nn_oof2。
最终将lgb_oof、nn_oof、stacking_oof、lgb_oof2、nn_oof2作为特征，重新训练模型3（LightGBM ），得到测试数据的预测结果，提交后即可达到线上最高分。
